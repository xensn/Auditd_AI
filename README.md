# Auditd_AI

A machine learning-based intrusion detection system that uses Linux audit logs (auditd) to identify and classify security threats in real-time.

## üéØ Overview

Auditd_AI is a comprehensive security monitoring toolkit that combines attack simulation, data processing, and machine learning to detect malicious activities on Linux systems. The system can identify and classify four primary attack categories:

- **Reconnaissance**: Network scanning, service enumeration, system information gathering
- **Privilege Escalation**: Attempts to gain elevated system privileges
- **Persistence**: Techniques to maintain long-term access to compromised systems
- **Data Exfiltration**: Unauthorized data transfer and theft attempts

## üìÅ Project Structure

```
Auditd_AI/
‚îú‚îÄ‚îÄ attack_sim1.sh        # Attack simulation and data generation script
‚îú‚îÄ‚îÄ data_format.py        # Data cleaning and preprocessing script
‚îú‚îÄ‚îÄ auditd_ml.ipynb      # Machine learning model training notebook
‚îú‚îÄ‚îÄ test.py              # Simple Python test script
‚îî‚îÄ‚îÄ README.md            # This file
```

## üöÄ Features

### 1. Attack Simulation (`attack_sim1.sh`)

A sophisticated Bash script that generates realistic, labeled training data by simulating both malicious and benign activities on a Linux system.

**Key Capabilities:**
- Executes configurable attack and benign sessions in randomized order
- Captures auditd system call events for each activity
- Automatically labels data with attack types or "BENIGN" classification
- Introduces random delays between commands to simulate realistic timing
- Filters out noise from ausearch utility commands

**Simulated Attack Types:**

**Reconnaissance Commands:**
- Network enumeration: `ip addr`, `netstat`, `ss`, `arp`
- System discovery: `ps aux`, `whoami`, `id`, `uname -a`
- Service enumeration: `service --status-all`, `nmap`
- SUID binary detection: `find / -type f -perm -4000`

**Privilege Escalation Commands:**
- Sudo privilege checks: `sudo -l`
- Capability enumeration: `getcap -r /`
- Sensitive file access: `cat /etc/passwd`, `cat /etc/shadow`
- Root process enumeration: `ps aux | grep root`
- SUID/SGID binary searches

**Persistence Commands:**
- Scheduled task enumeration: `crontab -l`, `systemctl list-timers`
- Startup script inspection: `cat ~/.bashrc`, `cat ~/.profile`
- System initialization checks: `ls -la /etc/cron.*`

**Data Exfiltration Commands:**
- Data compression: `tar -czf /tmp/data.tar.gz`
- File transfer simulation: `scp`, `curl`, `nc` (network commands)

**Benign Activity Commands:**
- Development tools: `git status`, `python3 --version`, `pip3 list`
- System monitoring: `uptime`, `df -h`, `free -h`, `top`
- Standard operations: `ls -la`, `pwd`, `which python3`
- Service management: `systemctl status ssh`, `journalctl`

**Usage:**
```bash
./attack_sim1.sh <ATTACK_SESSIONS> <BENIGN_SESSIONS>
```

**Example:**
```bash
# Run 5 attack sessions and 10 benign sessions
./attack_sim1.sh 5 10
```

**Output:** Creates `training_data.txt` with labeled audit log entries

**Important Notes:**
- Requires sudo privileges to run `ausearch` command
- Sessions are executed in random order to simulate realistic scenarios
- Each session contains 5-15 random commands from its category
- Random delays (20-60+ seconds) between commands and sessions
- Some commands may fail if required tools aren't installed (errors are suppressed)

### 2. Data Processing (`data_format.py`)

A Python script that transforms raw audit log data into clean, structured CSV format suitable for machine learning.

**Processing Pipeline:**
1. Reads raw audit logs from `training_data.txt`
2. Filters out separator lines containing "----"
3. Removes formatting characters (colons, quotes)
4. Combines multi-part message fields (msg=audit(...))
5. Special handling for PROCTITLE entries (combines command arguments)
6. Filters out ausearch command noise
7. Outputs clean data to `training_data.csv`

**Data Cleaning Steps:**
- Removes `:` and `"` characters from log entries
- Combines fragmented msg fields into single entries
- Merges PROCTITLE command arguments into coherent strings
- Skips lines generated by the ausearch utility itself

**Usage:**
```bash
python3 data_format.py
```

**Input Format:**
```
ATTACK_TYPE "type=SYSCALL msg=audit(...) arch=x86_64 syscall=execve ..."
```

**Output Format:**
CSV rows with cleaned, comma-separated fields:
```
ATTACK_TYPE,type=SYSCALL,msg=audit(...),arch=x86_64,syscall=execve,...
```

### 3. Machine Learning Analysis (`auditd_ml.ipynb`)

A Jupyter notebook providing an interactive environment for data analysis and model training.

**Included Components:**
- Data loading and preprocessing code
- Example data exploration from test audit logs
- Framework for training classification models
- Visualization setup (matplotlib, seaborn)
- Model evaluation using scikit-learn

**Libraries Used:**
- `pandas` - Data manipulation and analysis
- `numpy` - Numerical computing
- `matplotlib` - Data visualization
- `seaborn` - Statistical graphics
- `scikit-learn` - Machine learning algorithms

**Workflow in Notebook:**
1. Import required libraries
2. Load processed CSV data
3. Explore data structure and distributions
4. Feature engineering from audit log fields
5. Train/test split for model validation
6. Train classification models
7. Evaluate model performance

**Usage:**
```bash
jupyter notebook auditd_ml.ipynb
```

### 4. Test Script (`test.py`)

A simple Python utility demonstrating list slicing operations.

**Current Functionality:**
```python
x = [1,2,3,4,5,6]
del x[3:]
print(x)  # Output: [1, 2, 3]
```

This appears to be a basic test file and could be extended for unit testing the data processing functions.

## üìä Complete Workflow

### Step 1: Generate Training Data
```bash
# Generate labeled audit log data with 10 attack and 15 benign sessions
./attack_sim1.sh 10 15
# Output: training_data.txt
```

### Step 2: Process and Clean Data
```bash
# Convert raw logs to structured CSV format
python3 data_format.py
# Input: training_data.txt
# Output: training_data.csv
```

### Step 3: Train ML Model
```bash
# Open Jupyter notebook for analysis
jupyter notebook auditd_ml.ipynb
# Load training_data.csv
# Train classification model
# Evaluate performance
```

### Step 4: Deploy Detection (Future)
Apply trained model to real-time audit logs for intrusion detection.

## üîß Installation & Setup

### Prerequisites
```bash
# Ensure auditd is installed and running
sudo apt-get install auditd audispd-plugins
sudo systemctl start auditd
sudo systemctl enable auditd

# Install Python 3 and pip
sudo apt-get install python3 python3-pip

# Install Jupyter
pip3 install jupyter
```

### Install Python Dependencies
```bash
pip3 install pandas numpy matplotlib seaborn scikit-learn
```

### Clone and Setup
```bash
git clone https://github.com/xensn/Auditd_AI.git
cd Auditd_AI
chmod +x attack_sim1.sh
```

## üìù Data Format Specification

### Raw Log Format (training_data.txt)
Each line follows this pattern:
```
LABEL "type=EVENT_TYPE msg=audit(timestamp:id) field1=value1 field2=value2 ..."
```

**Example:**
```
RECONNAISSANCE "type=SYSCALL msg=audit(09/19/2025 18:17:32.558:12757524) arch=x86_64 syscall=execve success=yes exit=0 comm=nmap exe=/usr/bin/nmap"
BENIGN "type=SYSCALL msg=audit(09/19/2025 18:17:32.558:12757525) arch=x86_64 syscall=execve success=yes exit=0 comm=ls exe=/usr/bin/ls"
```

### Processed CSV Format (training_data.csv)
Comma-separated values with cleaned fields:
```
LABEL,type=EVENT_TYPE,msg=audit(timestamp:id),arch=architecture,syscall=syscall_name,...
```

### Label Categories
- `BENIGN` - Normal system operations
- `RECONNAISSANCE` - Information gathering activities
- `PRIVILEGE ESCALATION` - Privilege elevation attempts  
- `PERSISTENCE` - Persistence mechanism activities
- `DATA EXFILTRATION` - Data theft activities

## üéì Use Cases

### Security Research
- Study attack patterns and techniques
- Analyze system call sequences for malicious behavior
- Build behavioral profiles of different attack types

### ML Model Development
- Generate labeled datasets for supervised learning
- Train intrusion detection systems (IDS)
- Benchmark model performance on realistic data

### Security Operations
- Train security analysts on attack recognition
- Test and validate security monitoring tools
- Create baselines for anomaly detection systems

### Penetration Testing
- Validate detection capabilities of security tools
- Generate realistic attack scenarios for red team exercises
- Test incident response procedures

## ‚ö†Ô∏è Important Limitations

### System Requirements
- **Linux-only**: Requires Linux kernel audit subsystem (auditd)
- **Root access**: Needs sudo privileges for ausearch
- **Auditd configuration**: Must be properly configured and running

### Security Considerations
- **Test environments only**: Do NOT run on production systems
- **Alert triggering**: Simulated attacks will trigger real security alerts
- **Permission requirements**: Some commands require specific system permissions
- **Network scanning**: Nmap and network commands may violate security policies

### Data Quality
- Command failures are suppressed (may create incomplete datasets)
- System-specific variations in audit log format
- Requires manual review of generated data quality
- Ausearch noise filtering may miss some entries

## üîê Security & Ethics

**RESPONSIBLE USE ONLY**

This tool is intended for:
‚úÖ Authorized security research  
‚úÖ Educational purposes  
‚úÖ Testing in isolated lab environments  
‚úÖ Improving defensive security measures

This tool is NOT for:
‚ùå Unauthorized system access  
‚ùå Malicious activities  
‚ùå Testing on systems without explicit permission  
‚ùå Violating computer security policies

**Always obtain proper authorization before running security tools.**

## ü§ù Contributing

Contributions are welcome! Areas for improvement:

- Additional attack type simulations
- More sophisticated data preprocessing
- Pre-trained ML models
- Real-time detection capabilities
- Support for other audit frameworks
- Enhanced feature engineering
- Model performance benchmarks

**Guidelines:**
- Ensure all simulated attacks are safe and ethical
- Test thoroughly in isolated environments
- Document new features and changes
- Follow existing code style and structure

## üìÑ License

Please check the repository for license information.

## üë§ Author

**xensn** - [GitHub Profile](https://github.com/xensn)

## üôè Acknowledgments

This project leverages:
- Linux Audit Framework (auditd)
- scikit-learn machine learning library
- Community research on intrusion detection systems

---

**Note**: This is a research and educational tool. Always use responsibly and ethically.
